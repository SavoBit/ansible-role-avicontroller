[Unit]
Description=AVICONTROLLER
After=docker.service
Requires=docker.service

[Service]
TimeoutStartSec=0
Restart=always

ExecStartPre=-/usr/bin/docker rm -f avicontroller
ExecStartPre=/usr/bin/docker run {{ docker_run_params }}
ExecStart=/usr/bin/docker wait avicontroller
ExecStop=-/usr/bin/docker stop avicontroller
ExecStop=-/bin/bash -c "ip addr del $(ip addr | grep {{ dev_name }}:1 | awk '{print $2}') dev {{ dev_name }}"
ExecStopPost=-/usr/bin/docker rm -f avicontroller

[Install]
WantedBy=multi-user.target
